version: '2'
services:

  core-lightning:
    networks:
      - amazeeio-network
      - default
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - core-lightning:/root/.lightning
    user: '10000'
    ports:
      - 3003
    labels:
      lagoon.type: basic-persistent
      lagoon.persistent: /root/.lightning
      lagoon.service.port: 3003
    environment:
      LAGOON_LOCALDEV_HTTP_PORT: 3003
      LAGOON_ROUTE: http://core-lightning-rest.docker.amazee.io

    env_file:
      - .env.local

  # core-lightning-application:
  #   networks:
  #     - amazeeio-network
  #     - default
  #   build:
  #     context: .
  #     dockerfile: core-lightning-application.dockerfile
  #   volumes:
  #     - core-lightning:/data
  #   ports:
  #     - 2103
  #   labels:
  #     lagoon.type: basic-persistent
  #     lagoon.persistent: /data
  #     lagoon.service.port: 2103
  #     lagoon.autogeneratedroute: false
  #     lagoon.persistent.name: core-lightning
  #   environment:
  #     LAGOON_LOCALDEV_HTTP_PORT: 2103
  #     LAGOON_ROUTE: http://core-lightning-application.docker.amazee.io
  #   env_file:
  #     - .env.local

  rtl:
    networks:
      - amazeeio-network
      - default
    build:
      context: .
      dockerfile: rtl.dockerfile
    ports:
      - 3000
    user: '10000'
    volumes:
      - core-lightning:/core-lightning
    labels:
      lagoon.type: basic-persistent
      lagoon.persistent: /core-lightning
      lagoon.service.port: 3000
      lagoon.persistent.name: core-lightning
    environment:
      LAGOON_LOCALDEV_HTTP_PORT: 3000
      LAGOON_ROUTE: http://core-lightning-rtl.docker.amazee.io

networks:
  amazeeio-network:
    external: true


volumes:
  core-lightning: